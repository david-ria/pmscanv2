import{j as e}from"./query-BewfWFH7.js";import{r as l}from"./vendor-CRCfYjC_.js";import{c as U,a as M,u as q,B as u,R as A}from"./index-DnKT6hDb.js";import{I as c}from"./input-CGNY8--s.js";import{C as B,b as D,a as _}from"./card-CRF2Wp6a.js";import{L as d}from"./label-Dli8bNIx.js";import{T as H,a as V,b as y,c as N}from"./tabs-D4ABolrV.js";import{useNavigate as W}from"./router-D6wdMmGF.js";import{u as Y}from"./i18n-DZz6YkIP.js";import{M as z}from"./mail-R-xk0620.js";import{U as G}from"./user-plus-BWbi5Krx.js";import"./supabase--OITQzG1.js";import"./theme-D-6-9UvQ.js";import"./ui-core-CibF-ClQ.js";import"./utils-EL5wpLGY.js";import"./notifications-6vUXhpBr.js";import"./ui-forms-BvHfx7SG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=U("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);function me(){const[i,p]=l.useState(""),[m,f]=l.useState(""),[g,w]=l.useState(""),[x,b]=l.useState(""),[o,n]=l.useState(!1),[C,h]=l.useState(!1),[v,j]=l.useState(""),{signIn:E,signUp:k,resendConfirmationEmail:S,signInWithMagicLink:P}=M(),{toast:t}=q(),L=W(),{t:a}=Y(),I=async s=>{s.preventDefault(),n(!0),h(!1);try{const{error:r}=await E(i,m);r?(j(i),r.message?.toLowerCase().includes("email not confirmed")||r.message?.toLowerCase().includes("invalid credentials")?(h(!0),t({title:a("auth.connectionError"),description:'Your email may not be confirmed yet. Please check your email or click "Resend confirmation email" below.',variant:"destructive"})):t({title:a("auth.connectionError"),description:r.message,variant:"destructive"})):(t({title:a("auth.connectionSuccess"),description:a("auth.youAreConnected")}),L("/"))}catch{t({title:a("common.error"),description:a("auth.unexpectedError"),variant:"destructive"})}finally{n(!1)}},F=async s=>{s.preventDefault(),n(!0);try{const{error:r}=await k(i,m,{first_name:g,last_name:x});r?t({title:a("auth.registrationError"),description:r.message,variant:"destructive"}):(j(i),h(!0),t({title:a("auth.registrationSuccess"),description:a("auth.checkEmailConfirm")}))}catch{t({title:a("common.error"),description:a("auth.unexpectedError"),variant:"destructive"})}finally{n(!1)}},R=async()=>{if(v){n(!0);try{const{error:s}=await S(v);t(s?{title:"Error",description:s.message,variant:"destructive"}:{title:"Confirmation email sent",description:"Please check your email for the confirmation link."})}catch{t({title:"Error",description:"Failed to resend confirmation email",variant:"destructive"})}finally{n(!1)}}},T=async()=>{if(!i){t({title:"Email required",description:"Please enter your email address first.",variant:"destructive"});return}n(!0);try{const{error:s}=await P(i);t(s?{title:"Error",description:s.message,variant:"destructive"}:{title:"Magic link sent",description:"Please check your email for the sign-in link."})}catch{t({title:"Error",description:"Failed to send magic link",variant:"destructive"})}finally{n(!1)}};return e.jsx("main",{role:"main",className:"py-12",children:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(B,{className:"w-full max-w-md",children:[e.jsx(D,{children:e.jsx("h1",{className:"text-center text-2xl font-bold",children:a("auth.authentication")})}),e.jsx(_,{children:e.jsxs(H,{defaultValue:"signin",className:"w-full",children:[e.jsxs(V,{className:"grid w-full grid-cols-2",children:[e.jsx(y,{value:"signin",children:a("auth.signIn")}),e.jsx(y,{value:"signup",children:a("auth.signUp")})]}),e.jsx(N,{value:"signin",children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:a("auth.email")}),e.jsx(c,{id:"email",type:"email",placeholder:a("auth.emailPlaceholder"),value:i,onChange:s=>p(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"password",children:a("auth.password")}),e.jsx(c,{id:"password",type:"password",placeholder:a("auth.passwordPlaceholder"),value:m,onChange:s=>f(s.target.value),required:!0})]}),e.jsxs(u,{type:"submit",className:"w-full",disabled:o,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),a(o?"auth.connecting":"auth.signIn")]}),C&&e.jsxs(u,{type:"button",variant:"outline",className:"w-full mt-2",onClick:R,disabled:o,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Resend confirmation email"]}),e.jsxs(u,{type:"button",variant:"ghost",className:"w-full mt-2",onClick:T,disabled:o,children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Send me a sign-in link"]})]})}),e.jsx(N,{value:"signup",children:e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"firstName",children:a("auth.firstName")}),e.jsx(c,{id:"firstName",placeholder:a("auth.firstNamePlaceholder"),value:g,onChange:s=>w(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lastName",children:a("auth.lastName")}),e.jsx(c,{id:"lastName",placeholder:a("auth.lastNamePlaceholder"),value:x,onChange:s=>b(s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"signupEmail",children:a("auth.email")}),e.jsx(c,{id:"signupEmail",type:"email",placeholder:a("auth.emailPlaceholder"),value:i,onChange:s=>p(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"signupPassword",children:a("auth.password")}),e.jsx(c,{id:"signupPassword",type:"password",placeholder:a("auth.passwordPlaceholder"),value:m,onChange:s=>f(s.target.value),required:!0})]}),e.jsxs(u,{type:"submit",className:"w-full",disabled:o,children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),a(o?"auth.signingUp":"auth.signUp")]})]})})]})})]})})})}export{me as default};
