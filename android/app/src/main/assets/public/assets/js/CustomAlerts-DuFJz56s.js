import{j as e}from"./query-BewfWFH7.js";import{r as T}from"./vendor-CRCfYjC_.js";import{c as D,u as B,B as u}from"./index-DnKT6hDb.js";import{C as d,a as h,b as E,c as R}from"./card-CRF2Wp6a.js";import{I as f}from"./input-CGNY8--s.js";import{L as j}from"./label-Dli8bNIx.js";import{S as L}from"./separator-auhcLEBW.js";import{S as N}from"./switch-DiHL1fOt.js";import{useAlerts as M}from"./AlertContext-CLzf7XqW.js";import{M as I}from"./MenuPageHeader-CcnmbX7d.js";import{u as O}from"./i18n-DZz6YkIP.js";import{useNavigate as q}from"./router-D6wdMmGF.js";import{B as H}from"./bell-qdBZ5gP3.js";import{R as F}from"./rotate-ccw-oD7EDUkY.js";import{S as P}from"./save-DuXH8Fwl.js";import"./supabase--OITQzG1.js";import"./theme-D-6-9UvQ.js";import"./ui-core-CibF-ClQ.js";import"./utils-EL5wpLGY.js";import"./notifications-6vUXhpBr.js";import"./ui-forms-BvHfx7SG.js";import"./ui-advanced-6HbTI6G8.js";import"./useGroupSettings-DQBWUHal.js";import"./groupConfigs-C_MEEc6R.js";import"./useSubscription-DJEgHQrc.js";import"./client-zGYq1VIw.js";import"./useGroups-DlFUXECJ.js";import"./useUserRole-B8Vd-TTd.js";import"./supabaseSafeWrapper-C24d6oy5.js";import"./arrow-left-3u0J-11_.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=D("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);function Ne(){const{t}=O(),g=q(),{toast:m}=B(),{alertSettings:p,updateAlertSettings:b,resetToDefaults:v,globalAlertsEnabled:n,setGlobalAlertsEnabled:y}=M(),[i,o]=T.useState(p),C=(r,l)=>{const s=l===""?null:parseFloat(l);s!==null&&(isNaN(s)||s<0)||o(a=>({...a,[r]:{...a[r],threshold:s}}))},S=(r,l)=>{const s=parseInt(l);isNaN(s)||s<1||o(a=>({...a,[r]:{...a[r],duration:s}}))},k=(r,l)=>{o(s=>({...s,[r]:{...s[r],enabled:l}}))},x=r=>{for(const l of["pm1","pm25","pm10"]){const s=r[l];if(s.enabled&&(s.threshold===null||s.threshold<=0||s.duration<1))return!1}return!0},w=()=>{if(!x(i)){m({title:t("common.error"),description:t("alerts.validation.thresholdRequired"),variant:"destructive"});return}b(i),m({title:t("common.success"),description:t("alerts.saved")}),g("/profile")},A=()=>{v(),o(p),m({title:t("common.success"),description:t("alerts.resetToDefaults")})},c=(r,l)=>{const s=i[r];return e.jsxs(d,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{className:"text-lg",children:l}),e.jsx(N,{checked:s.enabled,onCheckedChange:a=>k(r,a)})]})}),e.jsx(h,{className:"space-y-4",children:s.enabled?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{className:"text-sm",children:t("alerts.thresholdLevel")}),e.jsx(f,{type:"number",min:"0",step:"0.1",value:s.threshold||"",onChange:a=>C(r,a.target.value),placeholder:"Ex: 25",className:"text-center"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{className:"text-sm",children:t("alerts.exposureDuration")}),e.jsx(f,{type:"number",min:"1",step:"1",value:s.duration,onChange:a=>S(r,a.target.value),className:"text-center"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("alerts.minimumDuration")})]}),s.threshold!==null&&e.jsx("div",{className:"mt-3 p-3 bg-primary/5 border border-primary/10 rounded-lg",children:e.jsx("p",{className:"text-sm text-center",children:t("alerts.alertWhen",{threshold:s.threshold,duration:s.duration})})})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:t("alerts.noAlertSet")})})})]},r)};return e.jsx("div",{className:"min-h-screen bg-background px-4 py-6",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsx(I,{title:t("alerts.title"),subtitle:t("alerts.subtitle")}),e.jsx(d,{className:"mb-6",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n?e.jsx(H,{className:"h-5 w-5 text-primary"}):e.jsx(V,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t(n?"alerts.enabled":"alerts.disabled")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("alerts.toggleDescription")})]})]}),e.jsx(N,{checked:n,onCheckedChange:y})]})})}),e.jsx(d,{className:"mb-6 border-primary/20 bg-primary/5",children:e.jsx(h,{className:"p-4",children:e.jsx("p",{className:"text-sm",children:t("alerts.description")})})}),e.jsxs("div",{className:"space-y-6",children:[c("pm1",t("alerts.pm1Alert")),c("pm25",t("alerts.pm25Alert")),c("pm10",t("alerts.pm10Alert"))]}),e.jsx(L,{className:"my-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(u,{variant:"outline",onClick:A,className:"flex-1 min-h-[44px] touch-manipulation",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),t("alerts.resetToDefaults")]}),e.jsxs(u,{onClick:w,className:"flex-1 min-h-[44px] touch-manipulation",disabled:!n&&!Object.values(i).some(r=>r.enabled),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),t("common.save")]})]}),!x(i)&&Object.values(i).some(r=>r.enabled)&&e.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-destructive",children:t("alerts.validation.thresholdRequired")})})]})})}export{Ne as default};
