import{c}from"./mapStyles-CsZyDteM.js";const l=e=>{e&&(e.getSource("track-line")||e.addSource("track-line",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),e.getSource("track-points")||e.addSource("track-points",{type:"geojson",data:{type:"FeatureCollection",features:[]}}))},d=(e,r)=>{e&&(e.getLayer("track-line")||e.addLayer({id:"track-line",type:"line",source:"track-line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),e.getLayer("track-points")||e.addLayer({id:"track-points",type:"circle",source:"track-points",paint:{"circle-radius":["case",["boolean",["feature-state","hovered"],!1],8,6],"circle-color":c(r),"circle-stroke-width":0,"circle-stroke-color":"transparent","circle-opacity":1}}))},u=(e,r,a)=>{if(!e||!e.getSource("track-points"))return;const n=r.map((t,o)=>({type:"Feature",id:o,geometry:{type:"Point",coordinates:[t.longitude,t.latitude]},properties:{pm25:t.pm25,timestamp:t.timestamp.toISOString()}}));if(e.getSource("track-points").setData({type:"FeatureCollection",features:n}),r.length>1){const t=r.map(o=>[o.longitude,o.latitude]);e.getSource("track-line").setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:t}})}if(!a&&r.length>0){const t=r.map(i=>[i.longitude,i.latitude]),o=e._createBounds?e._createBounds():null;t.length===1?(e.setCenter(t[0]),e.setZoom(15)):o&&(t.forEach(i=>{o.extend(i)}),e.fitBounds(o,{padding:50,duration:1e3}))}},y=(e,r)=>{!e||!e.getLayer("track-points")||(e.setPaintProperty("track-points","circle-color",c(r)),e.setPaintProperty("track-points","circle-stroke-width",0),e.setPaintProperty("track-points","circle-stroke-color","transparent"))};export{l as addTrackDataSources,d as addTrackLayers,y as updateLayerStyles,u as updateTrackData};
