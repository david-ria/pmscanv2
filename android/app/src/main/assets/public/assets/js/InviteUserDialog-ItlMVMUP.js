import{c as x,b as f,u as T,B as h}from"./index-DnKT6hDb.js";import{j as e}from"./query-BewfWFH7.js";import{r as d}from"./vendor-CRCfYjC_.js";import{D as Q,a as $,b as P,c as q,e as G,f as j}from"./dialog-DfKWiEIF.js";import{S as z}from"./ui-core-CibF-ClQ.js";import{F as A,C as V,f as H,g as B,r as J,h as K,b as W,o as X,s as Y}from"./ui-forms-BvHfx7SG.js";import{L as Z}from"./label-Dli8bNIx.js";import{I as k}from"./input-CGNY8--s.js";import{T as _,a as O,b as g,c as w}from"./tabs-D4ABolrV.js";import{a as ee,u as re}from"./useGroups-DlFUXECJ.js";import{g as b}from"./groupConfigs-C_MEEc6R.js";import{M as te}from"./mail-R-xk0620.js";import{D as se}from"./download-DC3Z7BQM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=x("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=x("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=x("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=x("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=x("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ie=A,C=d.createContext({}),ce=({...t})=>e.jsx(C.Provider,{value:{name:t.name},children:e.jsx(V,{...t})}),y=()=>{const t=d.useContext(C),n=d.useContext(F),{getFieldState:r,formState:s}=H(),a=r(t.name,s);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:o}=n;return{id:o,name:t.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...a}},F=d.createContext({}),N=d.forwardRef(({className:t,...n},r)=>{const s=d.useId();return e.jsx(F.Provider,{value:{id:s},children:e.jsx("div",{ref:r,className:f("space-y-2",t),...n})})});N.displayName="FormItem";const R=d.forwardRef(({className:t,...n},r)=>{const{error:s,formItemId:a}=y();return e.jsx(Z,{ref:r,className:f(s&&"text-destructive",t),htmlFor:a,...n})});R.displayName="FormLabel";const M=d.forwardRef(({...t},n)=>{const{error:r,formItemId:s,formDescriptionId:a,formMessageId:o}=y();return e.jsx(z,{ref:n,id:s,"aria-describedby":r?`${a} ${o}`:`${a}`,"aria-invalid":!!r,...t})});M.displayName="FormControl";const S=d.forwardRef(({className:t,...n},r)=>{const{formDescriptionId:s}=y();return e.jsx("p",{ref:r,id:s,className:f("text-sm text-muted-foreground",t),...n})});S.displayName="FormDescription";const E=d.forwardRef(({className:t,children:n,...r},s)=>{const{error:a,formMessageId:o}=y(),i=a?String(a?.message):n;return i?e.jsx("p",{ref:s,id:o,className:f("text-sm font-medium text-destructive",t),...r,children:i}):null});E.displayName="FormMessage";var le=function(t,n){for(var r={};t.length;){var s=t[0],a=s.code,o=s.message,i=s.path.join(".");if(!r[i])if("unionErrors"in s){var l=s.unionErrors[0].errors[0];r[i]={message:l.message,type:l.code}}else r[i]={message:o,type:a};if("unionErrors"in s&&s.unionErrors.forEach(function(v){return v.errors.forEach(function(p){return t.push(p)})}),n){var c=r[i].types,u=c&&c[s.code];r[i]=K(i,n,r,a,u?[].concat(u,s.message):s.message)}t.shift()}return r},de=function(t,n,r){return r===void 0&&(r={}),function(s,a,o){try{return Promise.resolve(function(i,l){try{var c=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](s,n)).then(function(u){return o.shouldUseNativeValidation&&B({},o),{errors:{},values:r.raw?s:u}})}catch(u){return l(u)}return c&&c.then?c.then(void 0,l):c}(0,function(i){if(function(l){return Array.isArray(l?.errors)}(i))return{values:{},errors:J(le(i.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw i}))}catch(i){return Promise.reject(i)}}};function I(t,n={},r){const{size:s=300,format:a="png",errorCorrectionLevel:o="M"}=n,i=b(t,r);return`https://api.qrserver.com/v1/create-qr-code/?${new URLSearchParams({data:i,size:`${s}x${s}`,format:a,ecc:o}).toString()}`}async function me(t,n,r={},s){const a=I(t,r,s);try{const o=await fetch(a);if(!o.ok)throw new Error(`Failed to fetch QR code: ${o.status}`);const i=await o.blob(),l=window.URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.download=n||`group-${t}-qr.${r.format||"png"}`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(l)}catch(o){throw console.error("Failed to download QR code:",o),new Error("Failed to download QR code")}}async function ue(t,n){const r=b(t,n);try{return await navigator.clipboard.writeText(r),!0}catch(s){console.error("Failed to copy to clipboard:",s);try{const a=document.createElement("textarea");return a.value=r,a.style.position="fixed",a.style.opacity="0",document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),!0}catch(a){return console.error("Fallback copy failed:",a),!1}}}const pe=X({email:Y().email("Please enter a valid email address")});function Ee({groupId:t,open:n,onOpenChange:r}){const{sendInvitation:s}=ee(),{groups:a}=re(),{toast:o}=T(),[i,l]=d.useState(!1),c=a.find(m=>m.id===t),u=b(t,c?.name),v=I(t,{size:256},c?.name),p=W({resolver:de(pe),defaultValues:{email:""}}),L=async m=>{l(!0);try{await s(t,m.email),p.reset(),r(!1)}catch{}finally{l(!1)}},D=async()=>{const m=await ue(t,c?.name);o(m?{title:"Success",description:"Group URL copied to clipboard"}:{title:"Error",description:"Failed to copy URL to clipboard",variant:"destructive"})},U=async()=>{try{const m=c?.name?`${c.name.toLowerCase().replace(/\s+/g,"-")}-invite.png`:`group-${t}-invite.png`;await me(t,m,{size:512},c?.name),o({title:"Success",description:"QR code downloaded successfully"})}catch{o({title:"Error",description:"Failed to download QR code",variant:"destructive"})}};return e.jsx(Q,{open:n,onOpenChange:r,children:e.jsxs($,{className:"sm:max-w-[500px]",children:[e.jsxs(P,{children:[e.jsx(q,{children:"Invite Members to Group"}),e.jsx(G,{children:"Choose how you want to invite people to join your group."})]}),e.jsxs(_,{defaultValue:"email",className:"w-full",children:[e.jsxs(O,{className:"grid w-full grid-cols-3",children:[e.jsxs(g,{value:"email",className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Email"]}),e.jsxs(g,{value:"link",className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Link"]}),e.jsxs(g,{value:"qr",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"QR Code"]})]}),e.jsxs(w,{value:"email",className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Send an invitation email with a personalized message."}),e.jsx(ie,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(L),className:"space-y-4",children:[e.jsx(ce,{control:p.control,name:"email",render:({field:m})=>e.jsxs(N,{children:[e.jsx(R,{children:"Email Address"}),e.jsx(M,{children:e.jsx(k,{type:"email",placeholder:"user@example.com",...m})}),e.jsx(S,{children:"Enter the email address of the person you want to invite"}),e.jsx(E,{})]})}),e.jsxs(j,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:i,children:"Cancel"}),e.jsx(h,{type:"submit",disabled:i,children:i?"Sending...":"Send Invitation"})]})]})})]}),e.jsxs(w,{value:"link",className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Share this link to let people join your group directly."}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:u,readOnly:!0,className:"flex-1 font-mono text-sm"}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:D,className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Copy"]})]})}),e.jsx(j,{children:e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Close"})})]}),e.jsxs(w,{value:"qr",className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Let people scan this QR code to join your group."}),e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"p-4 bg-white rounded-lg border",children:e.jsx("img",{src:v,alt:"Group invitation QR code",className:"w-48 h-48"})}),e.jsxs(h,{type:"button",variant:"outline",onClick:U,className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Download QR Code"]})]}),e.jsx(j,{children:e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Close"})})]})]})]})})}export{ce as F,Ee as I,Me as P,Se as T,N as a,R as b,M as c,E as d,ie as e,S as f,de as t};
