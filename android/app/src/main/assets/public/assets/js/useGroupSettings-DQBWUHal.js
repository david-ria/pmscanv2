import{r as c}from"./vendor-CRCfYjC_.js";import{useSearchParams as f}from"./router-D6wdMmGF.js";import{a as p}from"./groupConfigs-C_MEEc6R.js";import{u as v,a as A,d as m}from"./index-DnKT6hDb.js";import{u as h}from"./useSubscription-DJEgHQrc.js";const e={pm1:{good:10,moderate:20,poor:35},pm25:{good:12,moderate:35,poor:55},pm10:{good:50,moderate:100,poor:150}},l=[{id:"home",name:"Home",icon:"ğŸ ",description:"At home location",allowedActivities:["rest","work","indoor","cooking","cleaning","DIY"]},{id:"office",name:"Office",icon:"ğŸ¢",description:"At work/office",allowedActivities:["work","indoor","meeting","computer_work"]},{id:"school",name:"School",icon:"ğŸ«",description:"At school/university",allowedActivities:["indoor","studying","classroom","sport"]},{id:"indoor",name:"Indoor",icon:"ğŸŒ³",description:"Indoor air different than work and home",allowedActivities:["shopping","Parking","walking"]},{id:"Outdoor",name:"Outdoor",icon:"ğŸ™ï¸",description:"Outdoor activities in open air",allowedActivities:["walking","cycling","outdoor","jogging"]},{id:"transport",name:"Transport",icon:"ğŸš—",description:"In vehicle or public transport",allowedActivities:["transport","driving","bus","train","metro","undergroundTransport"]},{id:"underground",name:"Underground",icon:"ğŸš‡",description:"Underground transport (metro, subway)",allowedActivities:["undergroundTransport","escalator","stairs","stairsToOutside","standPlatform","stand"]}],u=[{id:"walking",name:"Walking",icon:"ğŸš¶",description:"Walking outdoors",availableAt:["park","mainStreet","school"]},{id:"cycling",name:"Cycling",icon:"ğŸš´",description:"Riding a bicycle",availableAt:["park","mainStreet"]},{id:"transport",name:"Transport",icon:"ğŸš—",description:"Using transportation",availableAt:["transport"]},{id:"driving",name:"Driving",icon:"ğŸš—",description:"Driving a car",availableAt:["transport"]},{id:"sport",name:"Sport",icon:"âš½",description:"Physical exercise or sports",availableAt:["park","school"]},{id:"rest",name:"Rest",icon:"ğŸ˜´",description:"Resting or sleeping",availableAt:["home"]},{id:"work",name:"Work",icon:"ğŸ’¼",description:"Working activities",availableAt:["home","office"]},{id:"indoor",name:"Indoor",icon:"ğŸ ",description:"General indoor activities",availableAt:["home","office","school"]},{id:"outdoor",name:"Outdoor",icon:"ğŸŒ¤ï¸",description:"General outdoor activities",availableAt:["park","mainStreet"]},{id:"undergroundTransport",name:"Underground transport",icon:"ğŸš‡",description:"Metro or subway",availableAt:["transport"]},{id:"jogging",name:"Jogging",icon:"ğŸƒ",description:"Running or jogging",availableAt:["park"]},{id:"shopping",name:"Shopping",icon:"ğŸ›’",description:"Shopping activities",availableAt:["mainStreet"]},{id:"cooking",name:"Cooking",icon:"ğŸ‘¨â€ğŸ³",description:"Cooking or food preparation",availableAt:["home"]},{id:"cleaning",name:"Cleaning",icon:"ğŸ§¹",description:"Household cleaning",availableAt:["home"]},{id:"studying",name:"Studying",icon:"ğŸ“š",description:"Reading or studying",availableAt:["home","school"]},{id:"meeting",name:"Meeting",icon:"ğŸ‘¥",description:"Business meetings",availableAt:["office"]},{id:"computer_work",name:"Computer work",icon:"ğŸ’»",description:"Working on computer",availableAt:["home","office"]},{id:"classroom",name:"Classroom",icon:"ğŸ“",description:"Attending classes",availableAt:["school"]},{id:"bus",name:"Bus",icon:"ğŸšŒ",description:"Traveling by bus",availableAt:["transport"]},{id:"train",name:"Train",icon:"ğŸšŠ",description:"Traveling by train",availableAt:["transport"]},{id:"metro",name:"Metro",icon:"ğŸš‡",description:"Traveling by metro/subway",availableAt:["transport"]},{id:"waiting",name:"Waiting",icon:"â³",description:"Waiting or standing",availableAt:["mainStreet","transport"]},{id:"relaxing",name:"Relaxing",icon:"ğŸ§˜",description:"Relaxing outdoors",availableAt:["park"]},{id:"DIY",name:"DIY",icon:"ğŸ”¨",description:"DIY and home improvement activities",availableAt:["home"]},{id:"Parking",name:"Parking",icon:"ğŸš—",description:"Underground parking",availableAt:["indoor"]},{id:"escalator",name:"Escalator",icon:"â¬†ï¸",description:"Using escalator in underground transport",availableAt:["underground"]},{id:"stairs",name:"Stairs",icon:"ğŸªœ",description:"Using stairs in underground transport",availableAt:["underground"]},{id:"stairsToOutside",name:"Stairs to outside",icon:"ğŸšª",description:"Using stairs from underground to surface",availableAt:["underground"]},{id:"stand",name:"Stand",icon:"ğŸ§",description:"Standing in underground transport",availableAt:["underground"]},{id:"standPlatform",name:"Stand platform",icon:"ğŸš‰",description:"Standing on underground platform",availableAt:["underground"]}];function O(a){const i=l.find(r=>r.id===a);return i?u.filter(r=>i.allowedActivities.includes(r.id)):[]}const R=()=>{const[a]=f(),[i,r]=c.useState(null),[g,d]=c.useState(!1),{toast:n}=v(),{user:b}=A();return h(),c.useEffect(()=>{let o=a.get("group");if(!o){const t=Array.from(a.keys())[0];t&&t.includes("research-lab")&&(o=t)}if(m("Group ID from URL:",o),o){const t=p(o);m("Group config found:",t),t?(r(t),d(!0),localStorage.setItem("activeGroupId",o),localStorage.setItem("groupSettings",JSON.stringify(t)),n({title:"Group Settings Applied",description:`Now using settings for: ${t.name}`,duration:3e3})):(console.error("Group not found:",o),n({title:"Group Not Found",description:`Group "${o}" does not exist`,variant:"destructive"}))}else{const t=localStorage.getItem("activeGroupId");if(m("Stored group ID:",t),t){const s=p(t);s&&(r(s),d(!0))}}},[a,n]),{activeGroup:i,isGroupMode:g,clearGroupSettings:()=>{r(null),d(!1),localStorage.removeItem("activeGroupId"),localStorage.removeItem("groupSettings");const o=new URL(window.location.href);o.searchParams.delete("group"),window.history.replaceState({},"",o.toString()),n({title:"Group Settings Cleared",description:"Returned to personal settings"})},applyGroupById:o=>{const t=p(o);if(t){r(t),d(!0),localStorage.setItem("activeGroupId",o),localStorage.setItem("groupSettings",JSON.stringify(t));const s=new URL(window.location.href);return s.searchParams.set("group",o),window.history.replaceState({},"",s.toString()),n({title:"Group Settings Applied",description:`Now using settings for: ${t.name}`}),!0}else return n({title:"Group Not Found",description:`Group "${o}" does not exist`,variant:"destructive"}),!1},getCurrentThresholds:()=>i?i.thresholds:[{name:"Good",pm25_min:0,pm25_max:e.pm25.good,pm10_min:0,pm10_max:e.pm10.good,pm1_min:0,pm1_max:e.pm1.good,color:"#22c55e",enabled:!0},{name:"Moderate",pm25_min:e.pm25.good,pm25_max:e.pm25.moderate,pm10_min:e.pm10.good,pm10_max:e.pm10.moderate,pm1_min:e.pm1.good,pm1_max:e.pm1.moderate,color:"#eab308",enabled:!0},{name:"Poor",pm25_min:e.pm25.moderate,pm25_max:e.pm25.poor,pm10_min:e.pm10.moderate,pm10_max:e.pm10.poor,pm1_min:e.pm1.moderate,pm1_max:e.pm1.poor,color:"#f97316",enabled:!0},{name:"Very Poor",pm25_min:e.pm25.poor,pm10_min:e.pm10.poor,pm1_min:e.pm1.poor,color:"#ef4444",enabled:!0}],getCurrentSettings:()=>i?i.settings:{pm25_threshold:e.pm25.moderate,pm10_threshold:e.pm10.moderate,pm1_threshold:e.pm1.moderate,alarm_enabled:!0,auto_share_stats:!1,notification_frequency:"immediate",location_auto_detect:!1,activity_auto_suggest:!1,event_notifications:!0,weekly_reports:!1},getCurrentAlarms:()=>i?i.alarms:[{name:"Air Quality Alert",pm25_threshold:e.pm25.moderate,pm10_threshold:e.pm10.moderate,pm1_threshold:e.pm1.moderate,enabled:!1,notification_frequency:"immediate"}],getCurrentLocations:()=>i?i.locations:l.map(o=>({name:o.name,description:o.description})),getCurrentActivities:()=>i?i.activities:u.map(o=>({name:o.name,description:o.description,icon:o.icon})),getCurrentEvents:()=>i?i.events:[]}};export{l as D,u as a,O as g,R as u};
